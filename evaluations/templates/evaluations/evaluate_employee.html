{% extends 'evaluations/base.html' %}

{% load evaluations_extras %} <!-- بارگذاری تگ‌های اضافی -->

{% block content %}
<h2>ارزیابی کارمند: {{ employee.name }}</h2>
<form method="post">
    {% csrf_token %}
    
    <!-- بخش انتخاب ماه ارزیابی -->
    <div class="mb-3">
        <label for="month">ماه ارزیابی:</label>
        <select id="month" name="month" class="form-control" required>
            {% for m in 1|to_list:12 %}
                <option value="{{ m }}" {% if m == current_month %}selected{% endif %}>{{ m }}</option>
            {% endfor %}
        </select>
    </div>
    
    <!-- ناوبری تب‌ها -->
    <ul class="nav nav-tabs" role="tablist">
        {% for category in categories %}
            <li class="nav-item" role="presentation">
                <button class="nav-link {% if forloop.first %}active{% endif %}" id="tab-{{ forloop.counter }}" data-bs-toggle="tab" data-bs-target="#content-{{ forloop.counter }}" type="button" role="tab" aria-controls="content-{{ forloop.counter }}" aria-selected="{% if forloop.first %}true{% else %}false{% endif %}">
                    {{ category.category.name }}
                </button>
            </li>
        {% endfor %}
    </ul>

    <!-- محتوای تب‌ها -->
    <div class="tab-content">
        {% for category in categories %}
            <div class="tab-pane fade {% if forloop.first %}show active{% endif %}" id="content-{{ forloop.counter }}" role="tabpanel" aria-labelledby="tab-{{ forloop.counter }}">
                <h3>{{ category.category.name }}</h3>
                {% for question in category.questions %}
                    <div class="mb-3">
                        <label>{{ question.text }}</label>
                        {% with field_name="question_"|add:question.id %}
                            {{ form.fields|get_field:field_name }}
                        {% endwith %}
                    </div>
                {% endfor %}
            </div>
        {% endfor %}
    </div>

    <button type="submit" class="btn btn-primary">ارسال</button>
</form>
{% endblock %}
